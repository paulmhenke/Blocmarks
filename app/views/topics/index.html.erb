<h1>BlocMarks</h1>

<div class='row'>
  <div class='col-md-10'>
    <p>Add a blocmark by sending an email to example@app9e30c2c68f7d4bda946026da2d61c748.mailgun.org</p>
  </div>
  <div class='col-md-2'>
    <% if policy(@topics).create? %>
      <%= link_to "Create New Topic", new_topic_path, class: 'btn btn-success' %>
    <% end %>
  </div>
</div>

<div class='row'>
  <div class='col-md-12'>
    <% @topics.each do | topic | %>
      <h3><%= link_to topic.title, topic %></h3>
      <% if policy(topic).create? %>
        <%= link_to "Add a Bookmark", new_topic_bookmark_path(topic), class: 'btn btn-success'%>
      <% else %>
        <%= link_to "Log In to create and like Bookmarks!", user_session_path, class: 'btn btn-success' %>
      <% end %>
      <ul class='list-unstyled'>
        <% topic.bookmarks.each do | bookmark | %>
          <%= content_tag :li, id: "bookmark-#{bookmark.id}", class: "bookmark" do %>
            <%= link_to bookmark.url, bookmark.url %>
            <div class='pull-right'>
              <% if policy(bookmark).destroy? %>
                <%= link_to bookmark_path(bookmark), method: :delete, remote: true, class: 'btn btn-primary btn-sm' do %>
                  <span class="glyphicon glyphicon-remove"></span>
                <% end %>
              <% end %>
              <%= render partial: 'likes/like', locals: { bookmark: bookmark } %>
            </div>
          <% end %>
        <% end %>
      </ul>
    <% end %>
  </div>
  
</div>
